---

- hosts: all
  become: true
  pre_tasks:

  - name: upgrade all packages
    tags: always
    yum: 
      update_cache: yes
    when: ansible_distribution == "CentOS"

  - name: Updating Ubuntu
    tags: always
    apt:
      update_cache: yes
    when: ansible_distribution == "Ubuntu"

- hosts: web_servers
  become: true
  tasks:

  - name: removing tmux in "Ubuntu" 
    tags: tmux,ubuntu,remove
    when: ansible_distribution =="Ubuntu"
    package:
     name:
        - tmux
     state: absent 

  - name: removing tmux in "CentOS"
    tags: tmux,centos,remove
    when: ansible_distribution =="CentOS"
    package:
     name:
        - tmux 
     state: absent 

- hosts: ftp_servers  
  become: true
  tasks:

  - name: install tmux in Ubuntu
    tags: tmux,install,ubuntu
    when: ansible_distribution == "Ubuntu"
    package:
     name:
        - tmux  
     state: latest 

  - name: install tmux in CentOS
    tags: tmux,install,centos
    when: ansible_distribution == "CentOS"
    package:
     name:
        - tmux
     state: latest   

- hosts: db_servers
  become: true
  tasks:

  - name: install apache in Centos
    tags: httpd,apache2
    when: ansible_distribution ==  "CentOS"    
    package:
     name: 
        - httpd
     state: latest
  - name: install apache in Ubuntu
    tags: apache2,httpd
    when: ansible_distribution == "Ubuntu"
    package:
     name:
        - apache2 
     state: latest

- hosts: time_servers
  tags: ntp
  become: true
  tasks:

  - name: install ntp in centOS
    when: ansible_distribution == "CentOS"
    package:
     name:
        - ntp
     state: latest

  - name: install ntp in ubuntu
    when: ansible_distribution == "Ubuntu"
    package: 
     name: 
        - ntp
     state: latest

      
